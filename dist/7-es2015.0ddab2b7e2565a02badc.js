(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{Yj9t:function(e,t,n){"use strict";n.r(t),n.d(t,"NgxAuthModule",(function(){return I}));var r=n("ofXK"),o=n("3Pt+"),a=n("tyNb"),i=n("McNs"),s=n("tk/3"),l=n("fXoL");const d="http://localhost:3000/api/auth/",u={headers:new s.d({"Content-Type":"application/json"})};let c=(()=>{class e{constructor(e){this.httpClient=e}login(e,t){return this.httpClient.post(d+"login",{email:e,password:t},u)}register(e,t,n){return this.httpClient.post(d+"signup",{username:e,email:t,password:n},u)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](s.a))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=n("aceb");function m(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"nb-alert",18),l["\u0275\u0275listener"]("close",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().onClose()})),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.errorMessage,"\n")}}function p(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",20),l["\u0275\u0275text"](1," Email is required! "),l["\u0275\u0275elementEnd"]())}function f(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",20),l["\u0275\u0275text"](1," Email should be the real one! "),l["\u0275\u0275elementEnd"]())}function h(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275template"](1,p,2,0,"p",19),l["\u0275\u0275template"](2,f,2,0,"p",19),l["\u0275\u0275elementContainerEnd"]()),2&e){l["\u0275\u0275nextContext"]();const e=l["\u0275\u0275reference"](11);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.errors?null:e.errors.required),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.errors?null:e.errors.pattern)}}function b(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"p",20),l["\u0275\u0275text"](1," Password is required! "),l["\u0275\u0275elementEnd"]())}function w(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"p",20),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate2"](" Password should contain from ",e.getConfigValue("forms.validation.password.minLength")," to ",e.getConfigValue("forms.validation.password.maxLength")," characters ")}}function v(e,t){if(1&e&&(l["\u0275\u0275elementContainerStart"](0),l["\u0275\u0275template"](1,b,2,0,"p",19),l["\u0275\u0275template"](2,w,2,2,"p",19),l["\u0275\u0275elementContainerEnd"]()),2&e){l["\u0275\u0275nextContext"]();const e=l["\u0275\u0275reference"](20);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",null==e.errors?null:e.errors.required),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(null==e.errors?null:e.errors.minlength)||(null==e.errors?null:e.errors.maxlength))}}function C(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"nb-checkbox",21),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().user.rememberMe=t})),l["\u0275\u0275text"](1,"Remember me"),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("ngModel",e.user.rememberMe)}}const x=[{path:"",component:i.a,children:[{path:"login",component:(()=>{class e extends i.e{constructor(e,t,n){super(e,{},null,t),this.router=t,this.authService=n,this.isLoggedIn=!1,this.isLoginFailed=!1,this.errorMessage="",this.jwToken="",this.userId="",this.redirectDelay=this.getConfigValue("forms.login.redirectDelay"),this.showMessages=this.getConfigValue("forms.login.showMessages"),this.strategy=this.getConfigValue("forms.login.strategy"),this.rememberMe=this.getConfigValue("forms.login.rememberMe")}onSubmit(){this.submitted=!0,this.logina(this.user.email,this.user.password).subscribe(e=>{console.log(e),this.errorMessage="Authentication Successful",this.isLoginFailed=!1,this.isLoggedIn=!0,this.jwToken=e.token,this.userId=e.userId,this.reloadPage(this.jwToken)},e=>{this.errorMessage=e.error.error,this.isLoginFailed=!0,console.log(this.errorMessage)})}logina(e,t){return this.authService.login(e,t)}reloadPage(e){console.log(e),localStorage.setItem("access_token",e),this.router.navigate(["main-dashboard"])}ngOnInit(){}onClose(){this.submitted=!1}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](i.c),l["\u0275\u0275directiveInject"](a.c),l["\u0275\u0275directiveInject"](c))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-login"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:26,vars:17,consts:[["id","title",1,"title"],[1,"sub-title"],["status","danger","role","alert","closable","",3,"close",4,"ngIf"],["aria-labelledby","title",3,"ngSubmit"],["form","ngForm"],[1,"form-control-group"],["for","input-email",1,"label"],["nbInput","","fullWidth","","name","email","id","input-email","pattern",".+@.+\\..+","placeholder","Email address","fieldSize","large","autofocus","",3,"ngModel","status","required","ngModelChange"],["email","ngModel"],[4,"ngIf"],[1,"label-with-link"],["for","input-password",1,"label"],["routerLink","../request-password",1,"forgot-password","caption-2"],["nbInput","","fullWidth","","name","password","type","password","id","input-password","placeholder","Password","fieldSize","large",3,"ngModel","status","required","minlength","maxlength","ngModelChange"],["password","ngModel"],[1,"form-control-group","accept-group"],["name","rememberMe",3,"ngModel","ngModelChange",4,"ngIf"],["nbButton","","fullWidth","","status","primary","size","large",3,"disabled"],["status","danger","role","alert","closable","",3,"close"],["class","caption status-danger",4,"ngIf"],[1,"caption","status-danger"],["name","rememberMe",3,"ngModel","ngModelChange"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"h1",0),l["\u0275\u0275text"](1,"Login"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](2,"p",1),l["\u0275\u0275text"](3,"Crowd Management Platform"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](4,m,2,1,"nb-alert",2),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",(function(){return t.onSubmit()})),l["\u0275\u0275elementStart"](7,"div",5),l["\u0275\u0275elementStart"](8,"label",6),l["\u0275\u0275text"](9,"Email address:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"input",7,8),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.email=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](12,h,3,2,"ng-container",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",5),l["\u0275\u0275elementStart"](14,"span",10),l["\u0275\u0275elementStart"](15,"label",11),l["\u0275\u0275text"](16,"Password:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"a",12),l["\u0275\u0275text"](18,"Forgot Password?"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](19,"input",13,14),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.user.password=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](21,v,3,2,"ng-container",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"div",15),l["\u0275\u0275template"](23,C,2,1,"nb-checkbox",16),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](24,"button",17),l["\u0275\u0275text"](25," Log In "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](6),n=l["\u0275\u0275reference"](11),r=l["\u0275\u0275reference"](20);l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",t.submitted),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",t.user.email)("status",n.dirty?n.invalid?"danger":"success":"basic")("required",t.getConfigValue("forms.validation.email.required")),l["\u0275\u0275attribute"]("aria-invalid",!(!n.invalid||!n.touched)||null),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",n.invalid&&n.touched),l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("ngModel",t.user.password)("status",r.dirty?r.invalid?"danger":"success":"basic")("required",t.getConfigValue("forms.validation.password.required"))("minlength",t.getConfigValue("forms.validation.password.minLength"))("maxlength",t.getConfigValue("forms.validation.password.maxLength")),l["\u0275\u0275attribute"]("aria-invalid",!(!r.invalid||!r.touched)||null),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",r.invalid&&r.touched),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.rememberMe),l["\u0275\u0275advance"](1),l["\u0275\u0275classProp"]("btn-pulse",t.submitted),l["\u0275\u0275property"]("disabled",t.submitted||!e.valid)}},directives:[r.m,o.v,o.l,o.m,g.O,o.b,o.p,o.k,o.n,o.r,a.f,o.g,o.f,g.q,g.o,g.A],encapsulation:2}),e})()}]}];let M=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.g.forChild(x)],a.g]}),e})(),I=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.c,o.e,a.g,g.p,g.P,g.r,g.B,M,i.b.forRoot({strategies:[i.f.setup({name:"email",baseEndpoint:"http://localhost:3000/api",login:{endpoint:"/auth/login"},register:{endpoint:"/auth/register"}})],forms:{login:{redirectDelay:500,showMessages:{success:!0}},register:{redirectDelay:0,showMessages:{success:!0}}}})]]}),e})()}}]);